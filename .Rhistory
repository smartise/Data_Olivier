write.xlsx(Info, "Metadata_samples\\environmental_data.csv", rownames = FALSE)
write.xlsx(Info, "Metadata_samples\\environmental_data.csv")
write.xlsx(Info, "Metadata_samples\\environmental_data.xlsx")
nmds_result <- metaMDS(matrixITS2, distance = "bray")
View(nmds_result)
plot(nmds_result)
library(readr)
library(ggplot2)
library(ggfortify)
library(dplyr)
library(stats)
library(tidyr)
library(readtext)
library(lubridate)
library(stringr)
library(rstatix)
library(purrr)
library(readxl)
library(vegan)
library(gplots)
library(fossil)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
data <- read_delim("ITS2profile_panama_10-11-23\\420_20231006T230503_DBV_20231007T052214.profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
Info <- read.csv("Metadata_samples\\data_matt.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
data <- data[-(1:5), -1 ]
data <- data[-c(569, 570), ]
data[1,1] <- "ID"
data <- as.data.frame(data)
colnames(data) <- data[1, ]  # Set the first column as row names
data <- data[-1,]          # Remove the first column from the data frame
data<-gather(data, ITS2, conc, 2:ncol(data))
data$conc <- as.numeric(data$conc)
################################traitement donnée info#####################################
Info <- Info[,c(3,4,5,6,10,15)]
colnames(Info)[colnames(Info) == "DNA.ID"] <- "ID"
colnames(Info)[colnames(Info) == "Sample.number...ARMS.Unit"] <- "colony"
colnames(Info)[colnames(Info) == "Station.number"] <- "replicate"
Info$colony <- substr(Info$colony, start=10, stop=12)
#################################merge of the profile #####################################
data <- data %>% filter(conc != 0)
data <- data[!grepl("BLANK-.", data$ID), ]
data <- merge(data, Info, by = "ID")
species <- species[,c(2,6)]
colnames(species)[colnames(species) == "Colony"] <- "colony"
species$colony <- as.character(species$colony)
data <- merge(species, data, by = "colony", all.x = TRUE)
data$species_colony <- paste(data$species, data$colony)
View(Info)
View(data)
matrixITS2 <- create.matrix(data, tax.name="ITS2", locality="ID", abund = TRUE, abund.col="conc")
nmds_result <- metaMDS(matrixITS2, distance = "bray")
plot(nmds_result)
pheatmap(matrixITS2)
View(matrixITS2)
View(data)
data <- read_delim("ITS2profile_panama_10-11-23\\420_20231006T230503_DBV_20231007T052214.profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
View(data)
nmds_df <- as.data.frame(nmds_result$points)
nmds_df$labels <- row.names(community_data)
View(nmds_df)
View(data)
View(nmds_df)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\ITS2profile_panama_10-11-23\\MarianaRochadeSouza-Kaneohe-Bay-2018-bf907a5")
######################################### Adding individual datasets ##############
## Symbiodiniaceae datasets
Profile_absolute<-readRDS("Symportal_proabsolute") #Profile absolute read numbers
Type_absolute<-readRDS("Symportal_abso") #Type absolute read numbers
Type_relative<-readRDS("Symportal_relat")#Type relative read numbers
Profile_absolute<-readRDS("Symportal_proabsolute") #Profile absolute read numbers
Type_absolute<-readRDS("Symportal_abso") #Type absolute read numbers
Type_relative<-readRDS("Symportal_relat")#Type relative read numbers
View(Profile_absolute)
View(Type_absolute)
View(Type_relative)
meta<-readRDS("depthmeta")
View(meta)
Relative<-Type_relative %>%
pivot_longer(c("B1": "F3.1"), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
View(Relative)
Absolute<-Type_absolute %>%
pivot_longer(c("B1": "F3.1"), names_to = "symbtypes", values_to = "absolute")%>%
mutate(absolute= as.numeric(absolute)) %>%
filter(absolute != 0)
ProfileAb<-Profile_absolute%>%
pivot_longer(c(2:32), names_to = "Profiles", values_to = "absoluteepro")%>%
mutate(absoluteepro= as.numeric(absoluteepro)) %>%
filter(absoluteepro != 0)
View(ProfileAb)
View(Profile_absolute)
View(Type_absolute)
View(Profile_absolute)
View(Type_absolute)
View(Relative)
Absolute<-Type_absolute %>%
pivot_longer(c("B1": "F3.1"), names_to = "symbtypes", values_to = "absolute")%>%
mutate(absolute= as.numeric(absolute)) %>%
filter(absolute != 0)
ProfileAb<-Profile_absolute%>%
pivot_longer(c(2:32), names_to = "Profiles", values_to = "absoluteepro")%>%
mutate(absoluteepro= as.numeric(absoluteepro)) %>%
filter(absoluteepro != 0)
View(ProfileAb)
View(Type_absolute)
View(Type_absolute)
View(Profile_absolute)
Info <- read.csv("Metadata_samples\\data_matt.csv")
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
Info <- read.csv("Metadata_samples\\data_matt.csv")
View(Info)
library(readr)
library(ggplot2)
library(ggfortify)
library(dplyr)
library(stats)
library(tidyr)
library(readtext)
library(lubridate)
library(stringr)
library(rstatix)
library(purrr)
library(readxl)
library(writexl)
library(gridExtra)
library(jpeg)
library(grid)
library(googlesheets4)
library(googledrive)
library(DT)
setwd("C:\\Users\\olivi\\OneDrive - Universite de Liege\\OBSIDIAN\\Project Panama\\")
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\Metadata_samples")
########################## traitement csv matt#############################################
data <- read.csv("data_matt.csv")
library(readr)
library(ggplot2)
library(ggfortify)
library(dplyr)
library(stats)
library(tidyr)
library(readtext)
library(lubridate)
library(stringr)
library(rstatix)
library(purrr)
library(readxl)
library(writexl)
library(gridExtra)
library(jpeg)
library(grid)
library(googlesheets4)
library(googledrive)
library(DT)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\Metadata_samples")
#sheet <- drive_get(path = "https://docs.google.com/spreadsheets/d/1PQhLMpu4syPWe8bu-Oq2eGqD4wQr94ExNmKny_h8UpQ/edit?pli=1#gid=0")
#drive_download(sheet, path = "data_matt.csv", overwrite = TRUE, type = "csv")
########################## traitement csv matt#############################################
data <- read.csv("data_matt.csv")
data <- data[,c(2,3,4,5,6,10,15,29)]
colnames(data)[colnames(data) == "DNA.ID"] <- "ID"
colnames(data)[colnames(data) == "Sample.number...ARMS.Unit"] <- "colony"
colnames(data)[colnames(data) == "Station.number"] <- "replicate"
data$colony <- substr(data$colony, start=10, stop=12)
############################ ajoux des espèces #############################################
species <- read.csv("Diana_Blast_231023.csv")
species <- species[,c(2,6)]
colnames(species)[colnames(species) == "Colony"] <- "colony"
species$colony <- as.character(species$colony)
temp <- which(species$colony == 158) #correction diana
species$colony[species$colony == 159] <- 158
species$colony[temp] <- 159
############################ fusion########################################################
info<- merge(data, species, by = "colony")
library(DT)
datatable(info) %>%
formatStyle(columns = 'species',
target = 'cell',
fontStyle = 'italic')
View(info)
write.csv(info, "info.csv", row.names = FALSE)
Info <- read.csv("Metadata_samples\\Info.csv")
Info <- read.csv("Metadata_samples\\info.csv")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
Info <- read.csv("Metadata_samples\\info.csv")
View(Info)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
View(absolute_abund)
View(relative_abund)
data <- data[-(1:5), -1 ]
data <- data[-c(569, 570), ]
data[1,1] <- "ID"
data <- as.data.frame(data)
colnames(data) <- data[1, ]  # Set the first column as row names
data <- data[-1,]          # Remove the first column from the data frame
data<-gather(data, ITS2, conc, 2:ncol(data))
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
data <- data[-(1:5), -1 ]
data <- data[-c(569, 570), ]
data[1,1] <- "ID"
data <- as.data.frame(data)
colnames(data) <- data[1, ]  # Set the first column as row names
data <- data[-1,]          # Remove the first column from the data frame
data<-gather(data, ITS2, conc, 2:ncol(data))
View(data)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\ITS2profile_panama_10-11-23\\MarianaRochadeSouza-Kaneohe-Bay-2018-bf907a5")
######################################### Adding individual datasets ##############
## Symbiodiniaceae datasets
Profile_absolute<-readRDS("Symportal_proabsolute") #Profile absolute read numbers
Type_absolute<-readRDS("Symportal_abso") #Type absolute read numbers
Type_relative<-readRDS("Symportal_relat")#Type relative read numbers
meta<-readRDS("depthmeta")
View(Type_relative)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\nfo.csv")
View(relative_abund)
relative_abund <- relative_abund[-(1:5), -1 ]
View(absolute_abund)
View(relative_abund)
data[1,1] <- "ID"
relative_abund[1,1] <- "ID"
View(relative_abund)
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
View(relative_abund)
relative_abund <- relative_abund[-1,]
View(relative_abund)
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
View(relative_abund)
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(569, 570), ]
View(relative_abund)
View(Profile_absolute)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\nfo.csv")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(569, 570), ]
relative_abund <- relative_abund[!grepl("BLANK-.", data$ID), ]
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(569, 570), ]
relative_abund <- relative_abund[!grepl("BLANK-.", relative_abund$ID), ]
View(relative_abund)
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(569, 570), ]
View(relative_abund)
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
View(relative_abund)
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
View(relative_abund)
relative_abund <- relative_abund[-1,]
View(relative_abund)
relative_abund <- relative_abund[-c(568, 569), ]
View(relative_abund)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\ITS2profile_panama_10-11-23\\MarianaRochadeSouza-Kaneohe-Bay-2018-bf907a5")
######################################### Adding individual datasets ##############
## Symbiodiniaceae datasets
Profile_absolute<-readRDS("Symportal_proabsolute") #Profile absolute read numbers
Type_absolute<-readRDS("Symportal_abso") #Type absolute read numbers
Type_relative<-readRDS("Symportal_relat")#Type relative read numbers
View(Type_relative)
Relative<-Type_relative %>%
pivot_longer(c("B1": "F3.1"), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
View(Relative)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(568, 569), ]
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(568, 569), ]
View(relative_abund)
Relative<- relative_abund %>%
pivot_longer(c(2: 50), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
View(Relative)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(568, 569), ]
Relative<- relative_abund %>%
pivot_longer(c(2: 50), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
Relative<- relative_abund %>%
pivot_longer(c(2:50), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\ITS2profile_panama_10-11-23\\MarianaRochadeSouza-Kaneohe-Bay-2018-bf907a5")
######################################### Adding individual datasets ##############
## Symbiodiniaceae datasets
Profile_absolute<-readRDS("Symportal_proabsolute") #Profile absolute read numbers
Type_absolute<-readRDS("Symportal_abso") #Type absolute read numbers
Type_relative<-readRDS("Symportal_relat")#Type relative read numbers
## Metadata
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\ITS2profile_panama_10-11-23\\MarianaRochadeSouza-Kaneohe-Bay-2018-bf907a5")
######################################### Adding individual datasets ##############
## Symbiodiniaceae datasets
Profile_absolute<-readRDS("Symportal_proabsolute") #Profile absolute read numbers
Type_absolute<-readRDS("Symportal_abso") #Type absolute read numbers
Type_relative<-readRDS("Symportal_relat")#Type relative read numbers
Relative<-Type_relative %>%
pivot_longer(c("B1": "F3.1"), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
View(Type_relative)
View(Relative)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(568, 569), ]
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(568, 569), ]
View(relative_abund)
Relative<- relative_abund %>%
pivot_longer(c(2:93), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
View(Relative)
View(absolute_abund)
absolute_abund <- absolute_abund[-(1:5), -1 ]
absolute_abund[1,1] <- "ID"
colnames(absolute_abund) <- as.character(unlist(absolute_abund[1, ]))
absolute_abund <- absolute_abund[-1,]
absolute_abund <- absolute_abund[-c(568, 569), ]
Absolute<- absolute_abund %>%
pivot_longer(c(2:93), names_to = "symbtypes", values_to = "absolute")%>%
mutate(absolute= as.numeric(absolute)) %>%
filter(absolute != 0)
View(Absolute)
View(Info)
View(Relative)
View(Info)
View(Absolute)
dataITS2 <- inner_join(Relative,Absolute,by=c("ID","symbtypes"))%>%
left_join(.,ProfileAb,by=c("ID"))%>%
left_join(.,Info, by=c("ID"))%>%
mutate(Locality=as.factor(Locality),ID=as.factor(ID),Site=as.factor(Site), Season=as.factor(Season))%>%
mutate(clade = case_when(
str_detect(symbtypes, "A") ~ "A",
str_detect(symbtypes, "B") ~ "B",
str_detect(symbtypes, "C") ~ "C",
str_detect(symbtypes, "D") ~ "D",
str_detect(symbtypes, "E") ~ "E",
str_detect(symbtypes, "F") ~ "F",
TRUE ~ NA_character_))%>%
filter(clade=="C"| clade=="D")
dataITS2 <- inner_join(Relative,Absolute,by=c("ID","symbtypes"))%>%
left_join(.,Info, by=c("ID"))%>%
mutate(Locality=as.factor(Locality),ID=as.factor(ID),Site=as.factor(Site), Season=as.factor(Season))%>%
mutate(clade = case_when(
str_detect(symbtypes, "A") ~ "A",
str_detect(symbtypes, "B") ~ "B",
str_detect(symbtypes, "C") ~ "C",
str_detect(symbtypes, "D") ~ "D",
str_detect(symbtypes, "E") ~ "E",
str_detect(symbtypes, "F") ~ "F",
TRUE ~ NA_character_))%>%
filter(clade=="C"| clade=="D")
View(dataITS2)
View(dataITS2)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\ITS2profile_panama_10-11-23\\MarianaRochadeSouza-Kaneohe-Bay-2018-bf907a5")
######################################### Adding individual datasets ##############
## Symbiodiniaceae datasets
Profile_absolute<-readRDS("Symportal_proabsolute") #Profile absolute read numbers
Type_absolute<-readRDS("Symportal_abso") #Type absolute read numbers
Type_relative<-readRDS("Symportal_relat")#Type relative read numbers
View(Type_absolute)
absol_sum<-absolute_abund%>% #data set with absolute read number values per sample ID
mutate(Totalrow=rowSums (.[2:284] )) %>%
filter(Totalrow>=250)%>% #standardizing number of reads to 2 std above and below mean
filter(Totalrow<=16560) %>%
select (ID)
absol_sum<-absolute_abund%>% #data set with absolute read number values per sample ID
mutate(Totalrow=rowSums (.[2:93] )) %>%
filter(Totalrow>=250)%>% #standardizing number of reads to 2 std above and below mean
filter(Totalrow<=16560) %>%
select (ID)
View(absolute_abund)
View(absolute_abund)
View(Absolute)
View(Type_absolute)
absol_sum<-absolute_abund%>% #data set with absolute read number values per sample ID
mutate(Totalrow=rowSums (.[2:93] )) %>%
filter(Totalrow>=250)%>% #standardizing number of reads to 2 std above and below mean
filter(Totalrow<=16560) %>%
select (ID)
absol_sum<-Type_absolute%>% #data set with absolute read number values per sample ID
mutate(Totalrow=rowSums (.[2:284] )) %>%
filter(Totalrow>=250)%>% #standardizing number of reads to 2 std above and below mean
filter(Totalrow<=16560) %>%
select (ID)
View(absol_sum)
absol_sum<-absolute_abund%>% #data set with absolute read number values per sample ID
mutate(Totalrow=rowSums (.[2:93] )) %>%
filter(Totalrow>=250)%>% #standardizing number of reads to 2 std above and below mean
filter(Totalrow<=16560) %>%
select (ID)
View(absolute_abund)
absol_sum<-absolute_abund%>% #data set with absolute read number values per sample ID
mutate(Totalrow=rowSums (.[2:93,] )) %>%
filter(Totalrow>=250)%>% #standardizing number of reads to 2 std above and below mean
filter(Totalrow<=16560) %>%
select (ID)
setwd("C:\\Users\\olivi\\OneDrive\\OneDrive liège\\OBSIDIAN\\Project Panama\\Data\\")
relative_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.relative.abund_and_meta.txt", delim="\t")  # assuming tab-delimited; adjust accordingly
absolute_abund<- read_delim("ITS2profile_panama_10-11-23\\profiles.absolute.abund_and_meta.txt", delim="\t")
Info <- read.csv("Metadata_samples\\info.csv")
species <- read_csv("Metadata_samples\\Diana_Blast_231023.csv")
################################traitement donnée de symportal################################
relative_abund <- relative_abund[-(1:5), -1 ]
relative_abund[1,1] <- "ID"
colnames(relative_abund) <- as.character(unlist(relative_abund[1, ]))
relative_abund <- relative_abund[-1,]
relative_abund <- relative_abund[-c(568, 569), ]
relative_abund <- relative_abund[!grepl("BLANK-.", relative_abund$ID), ]
Relative<- relative_abund %>%
pivot_longer(c(2:93), names_to = "symbtypes", values_to = "relative")%>%
mutate(relative= as.numeric(relative)) %>%
filter(relative != 0)
absolute_abund <- absolute_abund[-(1:5), -1 ]
absolute_abund[1,1] <- "ID"
colnames(absolute_abund) <- as.character(unlist(absolute_abund[1, ]))
absolute_abund <- absolute_abund[-1,]
absolute_abund <- absolute_abund[-c(568, 569), ]
absolute_abund <- absolute_abund[!grepl("BLANK-.", absolute_abund$ID), ]
Absolute<- absolute_abund %>%
pivot_longer(c(2:93), names_to = "symbtypes", values_to = "absolute")%>%
mutate(absolute= as.numeric(absolute)) %>%
filter(absolute != 0)
View(absolute_abund)
str(absolute_abund)
Absolute<- absolute_abund %>%
pivot_longer(c(2:93), names_to = "symbtypes", values_to = "absolute")%>%
mutate(absolute= as.numeric(absolute)) %>%
filter(absolute != 0)
absol_sum <-absolute_abund%>% #data set with absolute read number values per sample ID
mutate(Totalrow=rowSums (.[2:93] )) %>%
filter(Totalrow>=250)%>% #standardizing number of reads to 2 std above and below mean
filter(Totalrow<=16560) %>%
select (ID)
View(absolute_abund)
